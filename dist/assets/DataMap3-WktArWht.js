import{r as m,aD as S,aO as z,aA as T,j as i,aT as O,aG as C,aP as M,aB as D}from"./index-lfDruZJK.js";import{L as r,i as v,a as I,b as k,c as w,d as A,u as N,M as P,e as B,P as G,f as E,m as Z,T as U,t as F}from"./Dashboard-Y5TdBfvI.js";const J={airstrikeIconObject:r.icon({iconUrl:v,iconSize:[9,9],iconAnchor:[16,32],popupAnchor:[0,-32]}),armed_clashesIconObject:r.icon({iconUrl:I,iconSize:[9,9],iconAnchor:[16,32],popupAnchor:[0,-32]}),massacreIconObject:r.icon({iconUrl:k,iconSize:[9,9],iconAnchor:[16,32],popupAnchor:[0,-32]}),casualtiesIconObject:r.icon({iconUrl:w,iconSize:[9,9],iconAnchor:[16,32],popupAnchor:[0,-32]}),arrestsIconObject:r.icon({iconUrl:A,iconSize:[9,9],iconAnchor:[16,32],popupAnchor:[0,-32]})},R={1:"airstrikeIconObject",2:"armed_clashesIconObject",3:"massacreIconObject",4:"casualtiesIconObject",5:"arrestsIconObject"},_=()=>{const[y,x]=m.useState(null),[b]=S(),L=M(b.get("description")),o=E(),p={fillColor:"#fcfdfd",fillOpacity:"1",color:"#767574",weight:".75"},h={color:"#0000ff50",backgroundColor:"transparent",weight:"2"},f=()=>{o.fitBounds(y)};return m.useEffect(()=>{const c=r.layerGroup().addTo(o),a=r.layerGroup(),n=r.layerGroup(),l=new r.GeoJSON(Z,{onEachFeature:(s,t)=>{s.properties&&s.properties.DT&&(t.addTo(c),t.on({mouseover:()=>{t.setStyle(h)},mouseout:()=>{t.setStyle(p)},click:()=>{o.fitBounds(t.bindTooltip(s.properties.DT,{className:"click-part"}).getBounds())}}),t.addEventListener("mouseenter",function(){t.bindTooltip(s.properties.DT_MMR,{permanent:!0,direction:"center"})}),U(s,o,r),t.addTo(o))}}),g=new r.GeoJSON(F,{onEachFeature:(s,t)=>{s.properties&&s.properties.ts_eng&&(t.on({mouseover:()=>{t.setStyle(h)},mouseout:()=>{t.setStyle(p)},click:()=>{o.fitBounds(t.getBounds())}}),t.bindTooltip(s.properties.ST,{permanent:!0,direction:"center",className:"my-custom-tooltip"}),t.addTo(n))}}),d=l.getBounds();o.fitBounds(d),x(d),o.setMaxZoom(16),o.setMinZoom(4),l.setStyle(p),g.setStyle(p);const u=()=>{const s=o.getZoom();s<7?(o.hasLayer(c)||o.addLayer(c),o.hasLayer(a)&&o.removeLayer(a),o.hasLayer(n)&&o.removeLayer(n)):s>=7&&s<10?(o.hasLayer(c)&&o.removeLayer(l),o.hasLayer(a)||o.addLayer(a),o.hasLayer(n)&&o.removeLayer(n)):(o.hasLayer(c)&&o.removeLayer(l),o.hasLayer(a)&&o.removeLayer(a),o.hasLayer(n)||o.addLayer(n))};return o.on("zoomend",u),()=>{o.off("zoomend",u),o.removeLayer(c),o.removeLayer(a),o.removeLayer(n)}},[o]),i.jsxs("div",{children:[i.jsx("button",{className:"reset-zoom-button z-20",onClick:f,style:{position:"absolute",top:"10px",right:"10px",zIndex:1e3,backgroundColor:"#fff",border:"1px solid #ccc",padding:"5px 10px",cursor:"pointer"},children:"Reset Zoom"}),i.jsx(D,{size:"12px",fw:"600",style:{zIndex:1e3},className:"text-black absolute top-[50px] right-[12px] capitalize",children:L})]})},q=({height:y})=>{const[x,b]=m.useState({}),[L,o]=S();L.get("state"),m.useState([]);const{startDate:p,endDate:h}=z(),{filterParams:f}=T(),c=m.useMemo(()=>f.map(e=>e.id),[f]),a=m.useMemo(()=>c.map(e=>R[e]||""),[c]),{data:n,isLoading:l,isError:g}=N(new Date(p).toLocaleDateString("en-CA"),new Date(h).toLocaleDateString("en-CA"));if(l)return i.jsx(O,{height:"1140px"});if(g)return i.jsx(C,{height:"1140px"});const d=a.length>0?n==null?void 0:n.filter(e=>a.includes(e.icon)):n,u=(d==null?void 0:d.map(e=>({...e,icon:J[e==null?void 0:e.icon]})))||[],s=e=>{console.log(e),o({lat:e.position[0],lng:e.position[1],description:e.description})};console.log("case count",x);const t={doubleClickZoom:!0,closePopupOnClick:!0,dragging:!0,zoomSnap:!0,zoomDelta:!0,trackResize:!1,touchZoom:!1,zoomControl:!0,scrollWheelZoom:!1};return i.jsxs(P,{id:"leaflet-container",...t,className:"border-none shadow-sm rounded-md w-[100%] 2xl:h-[1000px] xl:h-[1000px] flex justify-center items-center z-10 text-black",children:[i.jsx(_,{}),u==null?void 0:u.map((e,j)=>i.jsx(B,{position:e.position,icon:e.icon,eventHandlers:{click:()=>s({position:e.position,description:e.popupText})},children:i.jsx(G,{children:e.popupText})},j))]})};export{q as default};
